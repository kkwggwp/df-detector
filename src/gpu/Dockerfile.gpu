# src/gpu/Dockerfile.gpu

# 1. ë² ì´ìŠ¤ ì´ë¯¸ì§€ ì„ íƒ
# FROM pytorch/pytorch:2.1.0-cuda12.1-cudnn8-runtime
FROM pytorch/pytorch:2.8.0-cuda12.9-cudnn9-runtime

# 2. ì‘ì—… ë””ë ‰í† ë¦¬ ì„¤ì •
WORKDIR /app

# 3. ğŸ’¥ ìˆ˜ì •: í•„ìš”í•œ íŒŒì¼ë“¤ì„ ì •í™•í•œ ê²½ë¡œì—ì„œ ë³µì‚¬í•©ë‹ˆë‹¤.
#    - requirements.gpu.txt -> ì»¨í…Œì´ë„ˆ ì•ˆì—ì„œëŠ” requirements.txtë¡œ ì´ë¦„ì„ ë³€ê²½
COPY requirements.gpu.txt ./requirements.txt
COPY src/gpu/models/ ./models/
COPY model_files/ ./model_files/
COPY src/gpu/worker.py ./

# 4. ë¼ì´ë¸ŒëŸ¬ë¦¬ ì„¤ì¹˜
RUN pip install --no-cache-dir -r requirements.txt

# 5. ì„œë²„ ì‹¤í–‰
CMD ["python", "worker.py"]